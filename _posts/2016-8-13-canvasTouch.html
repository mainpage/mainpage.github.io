<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>Document</title>
	<style type="text/css">
		html,body{
			width: 500px;
			margin: 0;
			padding: 0;
		}
		canvas{
			background-color: yellow;
		}
	</style>
</head>
<body>
	<canvas width="300px" height="500px">
		
	</canvas>
	<script>
	(function(){
		var ongoingTouches = [];
		var el = document.getElementsByTagName("canvas")[0];
		var ctx = el.getContext("2d");
		function startup() {
		  el.addEventListener("touchstart", handleStart, false);
		  el.addEventListener("touchend", handleEnd, false);
		  el.addEventListener("touchcancel", handleCancel, false);
		  el.addEventListener("touchleave", handleCancel, false);
		  el.addEventListener("touchmove", handleMove, false);
		}
		function handleStart(evt) {
		  evt.preventDefault();
		  var touches = evt.changedTouches;
		  for (var i=0; i<touches.length; i++) {
		    var color = 'green';
		    ctx.fillStyle = color;
		    console.log(touches[i].pageY);
		    ongoingTouches.push(touches[i]);
	        /*ctx.fillStyle = color;
	        ctx.fillRect(touches[i].pageX-2, touches[i].pageY-2, 4, 4);*/
	        ctx.beginPath();
	        ctx.arc(touches[i].pageX, touches[i].pageY, 5, 0, Math.PI*2);
	        ctx.fill();
		  }
		}

		function handleMove(evt) {
		  evt.preventDefault();
		  var touches = evt.changedTouches;
		  
		  ctx.lineWidth = 4;
		        
		  for (var i=0; i<touches.length; i++) {
		    var color = 'green';
		    var idx = ongoingTouchIndexById(touches[i].identifier);

		    ctx.strokeStyle = color;
		    ctx.beginPath();
		    ctx.moveTo(ongoingTouches[idx].pageX, ongoingTouches[idx].pageY);
		    ctx.lineTo(touches[i].pageX, touches[i].pageY);
		    ctx.closePath();
		    ctx.stroke();
		    ongoingTouches.splice(idx, 1, touches[i]);  // swap in the new touch record
		  }
		}

		function handleEnd(evt) {
		  evt.preventDefault();
		  var touches = evt.changedTouches;
		  
		  ctx.lineWidth = 4;
		        
		  for (var i=0; i<touches.length; i++) {
		    var color = 'red';
		    var idx = ongoingTouchIndexById(touches[i].identifier);
		    
		    ctx.fillStyle = color;
		    ctx.beginPath();
		    ctx.moveTo(ongoingTouches[i].pageX, ongoingTouches[i].pageY);
		    ctx.lineTo(touches[i].pageX, touches[i].pageY);
		    ongoingTouches.splice(i, 1);  // remove it; we're done
		  }
		}

		function handleCancel(evt) {
		  evt.preventDefault();
		  var touches = evt.changedTouches;
		  
		  for (var i=0; i<touches.length; i++) {
		    ongoingTouches.splice(i, 1);  // remove it; we're done
		  }
		}

		function ongoingTouchIndexById(idToFind) {
		  for (var i=0; i<ongoingTouches.length; i++) {
		    var id = ongoingTouches[i].identifier;
		    
		    if (id == idToFind) {
		      return i;
		    }
		  }
		  return -1;    // not found
		}
		
		startup();
	})();
	</script>
</body>
</html>